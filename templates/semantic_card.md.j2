# {{ card.title }}

## Labels

{% if card.labels and card.labels.grouping %}
- {{ card.labels.grouping | join(', ') }}
{% else %}
- none
{% endif %}

## Nodes (Shark_Name) ({{ card.total_nodes if card.total_nodes is defined else (card.node_names | length if card.node_names else 0) }})

{% if card.show_node_list %}
  {% if card.parent_groups and (card.parent_groups | length) > 0 %}
    {% for g in card.parent_groups %}
### {{ g.heading }} ({{ g.nodes | length }})

      {% for n in g.nodes %}
- {{ n }}
      {% endfor %}
    {% endfor %}
  {% else %}
### All Nodes ({{ card.node_names | length if card.node_names else 0 }})
    {% for n in card.node_names %}
- {{ n }}
    {% endfor %}
  {% endif %}
{% else %}
*(Node list suppressed for this level; total shown above.)*
{% endif %}

## Properties

{% if card.properties and (card.properties | length) > 0 %}
{% for p in card.properties %}
- {{ p.name }}
{% endfor %}
{% else %}
*(none)*
{% endif %}

## Relationships

{# Outgoing relationships only (Incoming intentionally omitted to avoid duplication) #}
{% set rels_out = (card.relationships.outgoing if card.relationships and card.relationships.outgoing else []) %}
{% set rels_out_gen = (card.relationships.outgoing_generalized if card.relationships and card.relationships.outgoing_generalized else []) %}

{% if card.show_node_list %}
### Outgoing ({{ rels_out | length }})

{% for grp in rels_out | groupby('from_name') %}
#### {{ grp.grouper }} ({{ grp.list | length }})

{% for r in grp.list %}
- ({{ r.from_name }}) - [{{ r.rel_type }}] -> ({{ r.to_name }})
  - Source Labels: {{ r.source_labels | join(', ') }}
  - Target Labels: {{ r.target_labels | join(', ') }}
{% endfor %}
{% endfor %}
{% else %}
### Outgoing (Actual Total) ({{ rels_out | length }})

### Outgoing (Generalized) ({{ rels_out_gen | length }})

{% for r in rels_out_gen %}
- ({{ r.from_level }}) - [{{ r.rel_type }}] -> ({{ r.to_level }}) ({{ r.count }})
{% endfor %}
{% endif %}

\newpage
